<style type="text/css">.v *{-webkit-box-sizing:border-box;box-sizing:border-box;line-height:1.8;color:#555;-webkit-transition:all .3s ease;transition:all .3s ease}.v .vinput{border:none;resize:none;outline:none;padding:10px 0;max-width:100%;font-size:.775rem}.v .vwrap{border:1px solid #f0f0f0;border-radius:4px;margin-bottom:10px;overflow:hidden;position:relative;padding:10px}.v .vwrap input{background:transparent}.v .vwrap .vheader .vinput{width:33.33%;border-bottom:1px dashed #dedede}.v .vwrap .vheader.item2 .vinput{width:50%}.v .vwrap .vheader.item1 .vinput{width:100%}.v .vwrap .vheader .vinput:focus{border-bottom-color:#eb5055}@media screen and (max-width:520px){.v .vwrap .vheader.item2 .vinput,.v .vwrap .vheader .vinput{width:100%}}.v .vwrap .vcontrol{font-size:0}.v .vwrap .vcontrol .col{display:inline-block;font-size:.725rem;vertical-align:middle;color:#ccc}.v .vwrap .vcontrol .col.text-right{text-align:right}.v .vwrap .vcontrol .col svg{margin-right:2px;overflow:hidden;fill:currentColor;vertical-align:middle}.v .vwrap .vcontrol .col.col-40{width:40%}.v .vwrap .vcontrol .col.col-60{width:60%}.v .vwrap .vcontrol .col.split{width:50%}.v .vwrap .vmark{position:absolute;background:rgba(0,0,0,.65);width:100%;height:100%;left:0;top:0}.v .vwrap .vmark .valert{padding-top:3rem}.v .vwrap .vmark .valert .vtext{color:#fff;padding:1rem 0}.v .vwrap .vmark .valert .vcode{width:4.6875rem;border-radius:.3125rem;padding:.5rem;background:#dedede}.v .vwrap .vmark .valert .vcode:focus{border-color:#3090e4;background-color:#fff}@media screen and (max-width:720px){.v .vwrap .vmark .valert{padding-top:5.5rem}.v .vwrap .vmark .valert .vtext{color:#fff;padding:1rem 0}}.v .power{color:#999}.v .power,.v .power a{font-size:.75rem}.v .vinfo{font-size:0;padding:5px}.v .vinfo .col{font-size:.875rem;display:inline-block;width:50%;vertical-align:middle}.v .vinfo .vcount .vnum{font-weight:600;font-size:1.25rem}.v a{text-decoration:none;color:#555}.v a:hover{color:#222}.v li,.v ul{list-style:none;margin:0 auto;padding:0}.v .txt-center{text-align:center}.v .txt-right{text-align:right}.v .pd5{padding:5px}.v .pd10{padding:10px}.v .veditor{width:100%;min-height:8.75rem;font-size:.875rem;background:transparent;resize:vertical}.v .vbtn{-webkit-transition-duration:.4s;transition-duration:.4s;text-align:center;color:#313131;border:1px solid #ededed;border-radius:1.9rem;display:inline-block;background:#ededed;margin-bottom:0;font-weight:400;vertical-align:middle;-ms-touch-action:manipulation;touch-action:manipulation;cursor:pointer;white-space:nowrap;padding:.5rem 1.25rem;font-size:.875rem;line-height:1.42857143;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;outline:none}.v .vbtn+.vbtn{margin-left:1.25rem}.v .vbtn:active,.v .vbtn:hover{color:#3090e4;border-color:#3090e4;background-color:#fff}.v .vempty{padding:1.25rem;text-align:center;color:#999}.v .vlist{width:100%}.v .vlist .vcard{padding-top:1.5rem;position:relative;display:block}.v .vlist .vcard:after{content:"";clear:both;display:block}.v .vlist .vcard .vimg{width:2.5rem;height:2.5rem;float:left;border-radius:50%;margin-right:.7525rem}.v .vlist .vcard .vhead{line-height:1.5;margin-bottom:.625rem;margin-top:0}.v .vlist .vcard .vhead .vname{font-size:.875rem;font-weight:700;margin-right:.875rem;cursor:pointer}.v .vlist .vcard .vhead .vname:hover{color:#d7191a}.v .vlist .vcard .vhead .vsys{display:inline-block;padding:.2rem .5rem;background:#ededed;color:#b3b1b1;font-size:.75rem;border-radius:.2rem;margin-right:.3rem}@media screen and (max-width:520px){.v .vlist .vcard .vhead .vsys{display:none}}.v .vlist .vcard section{overflow:hidden;padding-bottom:1.5rem;border-bottom:1px dashed #f5f5f5}.v .vlist .vcard section .vfooter{position:relative}.v .vlist .vcard section .vfooter .vtime{color:#b3b3b3;font-size:.75rem;margin-right:.875rem}.v .vlist .vcard section .vfooter .vat{font-size:.8125rem;color:#ef2f11;cursor:pointer}.v .vlist .vcard .vcontent{word-wrap:break-word;word-break:break-all;text-align:justify;color:#4a4a4a;font-size:.875rem;line-height:2;position:relative;margin-bottom:.75rem}.v .vlist .vcard .vcontent a{font-size:.875rem;color:#708090;-webkit-text-decoration:double;text-decoration:double}.v .vlist .vcard .vcontent a:hover{color:#d7191a}.v .vlist .vcard .vcontent .code,.v .vlist .vcard .vcontent code,.v .vlist .vcard .vcontent pre{overflow:auto;padding:2px 6px;word-wrap:break-word;color:#555;background:#f5f2f2;border-radius:3px;font-size:.875rem;margin:5px 0}.v .vlist .vcard .vcontent.expand{cursor:pointer;max-height:11.25rem;overflow:hidden}.v .vlist .vcard .vcontent.expand:before{display:block;content:"";position:absolute;width:100%;left:0;top:0;bottom:3.15rem;pointer-events:none;background:-webkit-gradient(linear,left top,left bottom,from(hsla(0,0%,100%,0)),to(hsla(0,0%,100%,.9)));background:linear-gradient(180deg,hsla(0,0%,100%,0),hsla(0,0%,100%,.9))}.v .vlist .vcard .vcontent.expand:after{display:block;content:"Click on expand";text-align:center;color:#828586;position:absolute;width:100%;height:3.15rem;line-height:3.15rem;left:0;bottom:0;pointer-events:none;background:hsla(0,0%,100%,.9)}.v .vpage{padding:1rem 0}.v .vpage i{display:inline-block;padding:.05rem .65rem;font-size:.785rem;border:1px solid #f0f0f0;font-style:normal;cursor:pointer}.v .vpage i+i{margin-left:.35rem}.v .vpage i.active{border:none;color:#ccc;cursor:default}.v .clear{content:"";display:block;clear:both}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@-webkit-keyframes pulse{50%{background:#dcdcdc}}@keyframes pulse{50%{background:#dcdcdc}}.v .vloading{text-align:center;padding-top:.875rem}.v .loading{display:inline-block;border-radius:50%;width:2rem;height:2rem;border:.25rem solid #a0a0a0;border-top-color:#dcdcdc;-webkit-animation:spin 1s infinite linear;animation:spin 1s infinite linear}.v .loading--double{border-style:double;border-width:.5rem}</style>

<div class="comments v" id="comments" style="opacity: 1; display: block;">
    <div class="vwrap">
        {% if logining %}
        <script>
            $('#comment_form').submit(function(e){
                e.preventDefault();
                $.ajax({
                    url:"{{submit_url}}",
                    type:'post',
                    data:$('#comment_form').serialize(),
                    success:function(){
                        $.ajax({url:"/message/{{post_id}}?next=" + encodeURIComponent(document.URL),success:function(result){
                            $("#comment").html(result);
                        }});
                    }
                });
            });
            $('#moe_text').keydown(function (e) {
                if (e.ctrlKey && e.keyCode == 13) {
                    $('#hit_me').click();
                }
            });
        </script>
        <form id="comment_form">
            <div class="vedit">
                <textarea id="moe_text" name="content" class="veditor vinput" placeholder="ヾﾉ≧∀≦)o来啊，快活啊!"></textarea>
                <input type="hidden" name="postid" value="{{ post_id }}">
            </div>
            {% else %}
            <form id="comment_form" action="/login" method="{{ method }}">
                <input name="next" type="hidden" value="{{ prev_href }}">
                {% endif %}
                <div class="vcontrol">
                    <div class="col col-60" title="MarkDown is Support"><a href="https://segmentfault.com/markdown" target="_blank">MarkDown</a> is Support<label for="argee" style="display:none;"></label></div>
                    <div class="col col-40 text-right">
                        <button id="hit_me" type="submit" title="Ctrl+Enter" class="vsubmit vbtn">{{ submit_btn_name }}</button>
                    </div>
                </div>
            </form>
            <div style="display:none;" class="vmark"></div>
    </div>
    <div class="vinfo" style="display:block;">
        <div class="vcount col"><span class="vnum">{{ msg_count }}</span> 評論 </div>
    </div>
    {% for msg in messages %}
    <ul class="vlist">
        <li class="vcard" id="5b1a2aec67f35600318c2ca3">
            <img class="vimg" src="https://gravatar.cat.net/avatar/d41d8cd98f00b204e9800998ecf8427e?d=retro">
            <section>
                <div class="vhead"><span class="vname"><a href="/blog/{{msg[0]}}">{{msg[0]}}</a></span></div>
                <div class="vcontent">
                    <p> {{ msg[2]|safe }}</p>
                </div>
                <div class="vfooter">
                    <span class="vtime">{{ msg[1] }}</span>
                    {% if logining and (msg[0] == who or who == blogger) %}
                    <a class="del" href="javascript:void(0);" url="/message_del?id={{msg[3]}}">刪除</a>
                    {% endif %}
                    <div></div>
                </div>
            </section>
        </li>
    </ul>

    {% endfor %}
    <div class="vempty" style="display:none;"></div>

    <div class="vpage txt-center"></div>
    <div class="info">
        <div class="power txt-right">Only CSS and HTML Powered By <a href="https://valine.js.org" target="_blank">Valine</a><br>v1.1.8</div>
    </div>
</div>

<script>
    $(".del").click(function(){
        alert("he");
        $.ajax({
            url:$(this).attr("url"),
            success: function(result){
                $.ajax({url:"/message/{{post_id}}?next=" + encodeURIComponent(document.URL),success:function(result){
                    $("#comment").html(result);
                }});
            }});
    });
</script>
